<HTML>
<HEAD>
   <TITLE>Ganymede Log File Format</TITLE>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
</HEAD>
<BODY BGCOLOR="#FFFFFF">

<H1>
Ganymede Log File Format</H1>
<HR WIDTH="100%">

<p>The Ganymede server maintains a log that is intended to be both
easily parseable by humans and scannable on command by the
server on behalf of clients.</p>

The log file is a |-separated, line-oriented text file with the
following form:

<font color="#FF0000">
<pre>
date|readable date|eventClassToken|adminInvid|adminName|transactionId|objectInvids|text description|email addresses
</pre>
</font>

Where the fields are defined as follows:<br><br>

<TABLE BORDER=1 HSPACE="140" CELLSPACING=0 CELLPADDING=0>

<TR>
<TH ALIGN=CENTER>Field</TH>

<TH ALIGN=CENTER>Description</TH>
</TR>

<TR>
<TD>date</TD>
<TD>A 64 bit Java date code in ASCII form.. a sequence of digits
    comprising the date of the event in milliseconds since
    Midnight, Jan 1, 1970, UTC</TD>
</TR>

<TR>
<TD>readable date</TD>
<TD>The date of the event in a human readable form</TD>
</TR>

<TR>
<TD>eventClassToken</TD>
<TD>A short string token serving to identify the class of event.  This token
will be generated by code in the Ganymede server, in reference to an object
of type EventClass held in the Ganymede database.  The token will consist
of a string of characters not to include spaces, newlines, or vertical bars.</TD>
</TR>

<TR>
<TD>adminInvid</TD>
<TD>A Ganymede database pointer to the adminPersona that triggered the
event, if any.  This invid will be of the form 1:813, where the first
number is the Ganymede database object type, and the second is the
adminPersona's id within the adminPersona objectBase.</TD>
</TR>

<TR>
<TD>adminName</TD>
<TD>The human-readable name of the administrator who triggered the event,
or nothing if it was a system event.</TD>
</TR>

<TR>
<TD>transactionID</TD>
<TD>If this event is part of a transaction, this field will be a
string of the form name:date where name is the human-readable name of
the administrator who committed the transaction, and date is a long
integer representing the time of the transaction.  The date code is of
the same form as the date field discussed above.</TD>
</TR>

<TR>
<TD>objectInvids</TD>
<TD>A string of comma separated invids enumerating objects involved in
the event.  Invids are encoded in the same form as the adminInvid
field discussed above.</TD>
</TR>

<TR>
<TD>text description</TD>
<TD>A verbose description of the event, possibly including a
description of the before and after state of an object changed in a
transaction.</TD>
</TR>

<TR>
<TD>email addresses</TD>
<TD>If this event was mailed out to users in addition to being recorded
in the log, this field will contain a comma separated list of email
addresses that the event was mailed to.</TD>
</TR>

</TABLE>

<H2>General Notes on Log File Format</H2>

<UL>
<LI>
 Any fields that are not applicable to a particular entry will be left
 empty, leaving a pair of adjacent field separators.  For instance, a
 server restart event, performed  out of the context of a transaction and
 without a responsible administrator might look like:

<pre>
879791893|Mon Nov 17 12:38:13 1997|restart|||||Server restart|jonabbey@arlut.utexas.edu,mulvaney@arlut.utexas.edu
</pre>
</LI>

<LI>
 Any human readable string contained within the log file will have
 any embedded | character backslashed.  Any newlines contained within
 a field will be represented in Java style as '\n'.  Any actual '\' characters
 will be rendered as '\\'.  For instance:

<pre>
879791893|Mon Nov 17 12:38:13 1997|shutdown|||||The server was shutdown for:\nadmin console restart by admin supergash|gomod@arlut.utexas.edu
</pre>
</LI>

<LI>
 Event lines comprising a transaction are guaranteed to be contiguous in the log file.
</LI>

<LI>
 If the server is abnormally shut down, a line may be abruptly terminated.  When the
 server starts up, it will emit a newline to terminate any incomplete event record
 that may have been emitted to the log file before shutdown.  The incomplete record
 will be skipped during any programmatic scan of the log file.
</LI>

<LI>
 There is no predefined limit to the length of a logFile line.  If you can't handle
 lines of abitrary length, you should probably switch over to programming in either Perl or
 Java.  It's for your own good. 8-)
</UL>
</BODY>
</HTML>
